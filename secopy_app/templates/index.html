{% load static %}

<!DOCTYPE HTML>
<html>
   <head>
      <link rel="icon" type="image/x-icon" href="../static/images/favicon.ico">
      <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.css'%}">
      <link rel="stylesheet" type="text/css" href="{% static 'css/custom_css.css'%}">
      <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
      <script src="{% static 'js/bootstrap.js' %}"></script>
      <script src="{% static 'js/custom_js.js' %}"></script>
      <title>SeCoPy</title>
   </head>

   <body style="background-color:#eeeeee;">
    <div class="jumbotron jumbotron-fluid" style="margin-bottom:0px; background-color: #555; color: white;"> 
      <div class="container">
        <div class="row">
          <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
            <h1 class="display-4">SeCoPy</h1>
            <p class="lead">Secure Coding in Python</p>
          </div>
          {% if request.user.is_authenticated %}
            <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4" style="text-align: right;">
              <p>Hello, {{ user }}</p>
              <form action="logout/" method="POST">
                {% csrf_token %}
                <button type="submit" class="btn btn-dark" style="color:black;">Logout</button>
              </form>
            </div>
            {% else %}
            <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4" style="text-align: right;">
              <button type="button" onclick="location.href='/login'" class="btn btn-dark" style="color:black;">Login</button>
              <button type="button" onclick="location.href='/register'" class="btn btn-dark" style="color:black;">Register</button>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

       
       <div class="container mt-0" style="min-height:500px;">
         <div class="row">
           <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
             <div class="flex-shrink-0 p-3 bg-white">
               <ul class="list-unstyled ps-0">
                   <button class="btn btn-toggle align-items-center rounded collapsed.show" data-toggle="collapse" data-target="#home" style="background-color:#cccccc; width:85%; height:50px; color:black;" aria-expanded="true">
                     Home
                   </button>
                 <li class="mb-1">
                   <button class="btn btn-toggle align-items-center rounded collapsed" data-toggle="collapse" data-target=".theory" aria-expanded="true" style="background-color:#cccccc; width:85%; height:50px; color:black;">
                     Theory
                   </button>
                   <div class="theory collapse" id="theory-collapse">
                     <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                       <li><a href="#basics"><button type="button" class="btn btn-dark" style="width:85%; color:black;">Basics</button></a></li>
                       <li><a href="#standard_lib"><button type="button" class="btn btn-dark" style="width:85%; color:black;">Standard library</button></a></li>
                       <li><a href="#web_program"><button type="button" class="btn btn-dark" style="width:85%; color:black;">Web programming</button></a></li>
                       <li><a href="#others"><button type="button" class="btn btn-dark" style="width:85%; color:black;">Others</button></a></li>
                     </ul>
                   </div>
                 </li>
                 <li class="mb-1">
                   <button class="btn btn-toggle align-items-center rounded collased" data-toggle="collapse" data-target=".tests" aria-expanded="false" style="background-color:#cccccc; width:85%; height:50px; color:black;">
                    Test
                   </button>
                   <div class="tests collapse" id="test-collapse">
                     <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                      <li><a href="#basics_test"><button type="button" class="btn btn-dark" style="width:85%; color:black;">Basics</button></a></li>
                      <li><a href="#standard_test"><button type="button" class="btn btn-dark" style="width:85%; color:black;">Standard library</button></a></li>
                      <li><a href="#web_test"><button type="button" class="btn btn-dark" style="width:85%; color:black;">Web programming</button></a></li>
                     </ul>
                   </div>
                 </li>
                 <li class="border-top my-3"></li>
                 <li class="mb-1">
                   <button class="btn btn-toggle align-items-center rounded collapsed" data-toggle="collapse" data-target="#files" aria-expanded="false" style="color:black; background-color:#cccccc; width:85%; height:50px">
                     Files
                   </button>
                 </li>
               </ul>
             </div>
           </div>


           <!--Tool content-->
           <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8 collapse in" id="home">
             <h3>Welcome to SeCoPy!</h3>
             <p>This application is created for study purposes.</p>
           </div>

           <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
             <div class="collapse theory" id="guidelines">
            <h1>Secure Coding Guidelines for Python</h1>
              <div id="basics">
                <h2>Basics</h2>
                There are some important basics that needs to be shown to the programmer. They consist more of a right Python settings than some coding examples. Setting Python right can prevent many possible vulnerabilities.
                <h3>Version of Python</h3>
                The first basic that programmer needs to have in mind is the right version of Python. Many of the vulnerabilities have been repaired in the newer Python versions. For example in Python version 2.5 exists exploit, where can attacker cause buffer overflow via string in socketmodule.c.
                
                Preventing is simple by using the newest stable version of Python. If your company is using Python < 3.0, consider updating Python version and its dependencies. It is not only more secure, it is also offering better user experience. 
                You can check your Python version by typing this into your command line: <pre>$python --version</pre>
                <h3>Virtual environment</h3>
                The safest programming in Python should be in virtual environment. It is recommended to use it, because venv (virtual environment) can assure that Python projects are divided from the folder with Python itself. If project has some malicious modules or other security problems, it is limited only to this project and does not effect other Python projects on this device.
                <h3>Importing modules</h3>
                There are several methods how to import a module in Python. In particular absolute and relative import and implicit and explicit import. The best way to use import is to use absolute import. Example shows how absolute import looks like.
                
                <div class="text-center">
                <img src="../static/images/absolute.png" alt="Absolute module import">
                </div>
                
                Absolute import assures that programmer imports exactly what he wants. Relative import is from Python 3 on wards only explicit. Implicit import has been removed.
                
                For secure module import is recommended to use only absolute import or relative explicit import. Relative import only when programmer is importing from his own Python files. It is not recommended using relative import when importing third party modules.</br>
                
                The second problem with modules is that we do not need all from the module. We usually need only some of the functions or classes. In Python exists many ways how to import particular parts of modules. The best way how to import module is to specify class and function by absolute import.</br>
                Another way of importing that exists is <i>from sys import *</i>, but that is really insecure way of import. The first problem is that we are importing functions that we do not need and the second problem is that we usually do not know what is in the module. It means that there is probability which is rising with number of modules, that we download module with either malicious function or we overwrite the previous module.
                
                <div class="text-center">
                  <img src="../static/images/bad_import.png" alt="Wrong way how to import modules">
                </div>

                On the figure there is comparison between wrong importing, where importing time overwrites module asyncio. It is basic example form standard library, but it is important to show some of the basic mistakes. Both of the modules contains function <i>sleep()</i>. In the wrong example there is no prove that we are calling sleep from time or asyncio. In this case it depends on the latest import, which is time. The example below is better example, where from module time is selected only what is needed. The module asyncio is there only for the showing of no overriding.
                
                <div class="text-center">
                  <img src="../static/images/best_import.png" alt="The right way how to import modules">
                </div>

                <h4>Typosquatting</h4>
                The last warning in this topic is typo squatting. Typosquatting is kind of an attack that targets heedless programmers. It works like this: programmer writes an import, but makes a typo. Import is still not underlined as a mistake, why? Programmer has just imported a malicious package. Be careful with packages and check after yourself. There are dozens of malicious packages in PyPI. Example, where programmer typed <i>modulee_test</i> instead of <i>module_test</i>. In this example there is called only print, but it could be for example malicious module with system command.
                
                <div class="text-center">
                  <img src="../static/images/malicious_module.png" alt="One typo changes everything.">
                </div>
                
                <div class="text-center">
                  <img src="../static/images/mm_output.png" alt="Malicious output.">
                </div>

                From usable point of view is best practice to divide imports into three categories. The first category are standard library imports, the second are third party imports and the last one is local imports. Each category is sort in alphabetical order.
              </div>
              
              <div id="standard_lib">
                <h2>Standard Python</h2>
                In this section I will be dealing with things that are related to the coding itself. They are still basic, but their impact on security is much more significant. I will show some validation techniques and I will compare two main Python validating constructions. Then there will be flaws from the standard library like command injections and path manipulating.
                <h3>Input validation</h3>
                The right way of validating user input can assure that the program will be very secure. But there are many practices how to check user input. Some of them are better than others. In this section will be shown the right and most secure way of input validating.
                <h3>Blacklisting vs. whitelisting</h3>
                There are two main ways how to validate input. The first is blacklisting. Blacklisting means marking some inputs as forbidden. The main problem of this technique is that it is practically impossible to catch every wrong input because there are theoretically infinite wrong inputs that user can create therefore it is advisable using whitelisting.
                Whitelisting is a practice when programmer knows what the right input is and checks only the right input. It is more secure and also usable technique because it costs theoretically less conditions and less lines to create. It seems this statement is wrong, but blacklisting costs theoretically infinite number of lines. The most suitable technique for whitelisting is to create a regular expression for the right input. Regular expression (regex) is a sequence of characters that specifies a search pattern in text. Programmer should use regexes because one right regex can cover all the wrong inputs. There is also online regex tool which can be really helpful. Module <i>re</i> assures regular expressions for Python. Python also contains many built-in functions like <i>isdigit()</i> that can check if the string is digit or not.
                
                Finally, some examples on blacklisting, whitelisting and regular expressions. The goal of these examples is to explain the main differences between these techniques and the importance of the good regular expressions. Regexes are sometimes very hard to code right so I recommend using the online tool mentioned above.
                In this example the input has to be the string "Hello". First example uses blacklisting and the second one uses whitelisting with some regular expression. Which one looks safer?
                The example is very simple, but it proves the point because using whitelisting there is only one condition and using blacklisting there are four conditions and still it is not sufficient because word "Hallo" can be written on the output.
                
                <div class="text-center">
                  <img src="../static/images/blacklisting.png" alt="Bad practise using blacklisting.">
                </div>
                <div class="text-center">
                  <img src="../static/images/whitelisting.png" alt="Whitelisting with regex.">
                </div>

                <h3>Try-except vs. if-else</h3>
                In Python and other languages exist two main constructions for conditions. Try-except and if-else are used for flow and condition control. They work with similar logic, but the benefits from using one or the other can be quite significant. Try-except is ideal when programmer does not know about all possible errors that can occur. With one conditional block programmer can cover many errors. But it is not without a cost. If-else blocks are more efficient and it is recommended using them when we know possible errors. Try-except is faster when there is less possibility of error, but when the possibility declines, the if-else block becomes faster.
                When programmer is working with files it is recommended to use try-except block, because when some error happens when opening or closing file and try-except block is present none information are lost. Try-except block works with the system itself. In conclusion it is safer to use try-except block when we are not sure about possible errors or when there is small possibility of some error/exception. In the other cases it is recommended to use if-else block.
                
                <h3>Standard library flaws</h3>
                Flaws are in every aspect of programming languages. The first area which I would like to mention is standard library. In the standard library there are many modules, classes and functions. Among them are some functions which require caution. There is a possible injection, path changing also we have to be cautious when working with files and logs. There is a lot of topics for this subsection.
                
                <h3>Temporary files - <i>mktemp()</i></h3>
                Sometimes it is necessary to create temporary files when coding a program. In Python exists special module for this problem and it is called <i>tempfile</i>. It is a part of standard library. This module seems secure except one function <i>mktemp()</i>. Function <i>mktemp()</i> has been deprecated since Python 2.3, but it is still in the module. The advise is not to use the function works like this. Function creates link with absolute path to non existent file at that time. Before your program starts working with this path and creates real file, somebody else can steal this path and do whatever he wants with it. More precisely with created file.
                Instead of <i>mktemp()</i> use <i>mkstemp()</i> which is more secure or you can use function <i>tempfile.TemporaryFile()</i> like in example below.
                
                <div class="text-center">
                  <img src="../static/images/tempfile.png" alt="Proper creating of temporary file.">
                </div>

                <h3>Pickle module</h3>
                Python module pickle is used for serializing or de-serializing data from other sources. It can be used for sending or receiving object state. Pickle is converting byte streams to object structure and vise-versa. The vulnerability lies in the byte string, which is not formatted and it is prone to outside code execution.</br>
                The best solution for this vulnerabilities are:
                <ul>
                    <li>do not pickle or unpickle data from untrusted sources</li>
                    <li>use HMAC or other algorithms for ensuring integrity of data</li>
                    <li>use JSON instead of pickle</li>
                </ul>
                Examples could be found <a href="https://lincolnloop.com/blog/playing-pickle-security/">here</a>.
                
                <h3>Command injection (exec, eval, input, os)</h3>
                These built-in functions are vulnerable against the same problem. Command injection is a problem when attacker can execute code through other function or code. Problem occurs when programmer does not sanitize user's input. These selected functions are the most used ones, so they will be described and given solution.
                Eval is function which evaluates given expression through Python evaluating rules. It can be used for evaluating number expressions and so on. Return value is value from evaluated expression. Exec is a built-in function for executing Python code. Both of these functions face same problem with user input. Solution for right using of these functions is validating user input and not giving the input right into these functions. The third function is a little bit different.
                Function input reads user input and puts it into variable. In Python 2.x was possible create exploit like this:
                
                <div class="text-center">
                  <img src="../static/images/comm_inj_code.png" alt="Input exploit.">
                </div>
                <div class="text-center">
                  <img src="../static/images/comm_inj_out.png" alt="Python 3 has covered this exploit.">
                </div>

                This is fixed now, but for someone using older Python version (not recommended) it could be still a problem. Function input from version 3.0 converts input into the string that is the reason why in Python 3 is the condition false, but in Python 2.x is true because function converted given input as a variable. It means that the condition is for Python 2.x something like <i>var password == var password</i> which is true.
                Another functions which are frequently used are from os module. The most dangerous function is <i>os.system()</i> which uses only single string argument that is executed as command. That opens code for vulnerabilities therefore it is not recommended to use this function at all. And if it is necessary, check the argument is valid and be sure that it is really what you want to execute. Recommended function to execute commands is <i>subprocess.function()</i>. But there is also vulnerability if programmer sets argument <i>shell=True</i>. This means that argument can be in one string. Recommended tactic is give argument to function as a list and set shell to false.
                
                <div class="text-center">
                  <img src="../static/images/subprocess.png" alt="The right way of executing command.">
                </div>

                <h3>Regular expressions</h3>
                Even if regular expressions are efficient tool when checking user input, they are vulnerable against ReDoS attack. This attack uses algorithmic complexity against program. Complexity of regular expression can be up to 2^m that means some expressions would take with each character exponentially to evaluate. Thus programmer has to be careful when using regexes. There are some regexes that are forbidden due to its evaluation complexity against inputs like <i>aaaaaaaaaaaaaaaaaaaaaaaaaaa!</i>. List of evil regexes can be found here.
                
                <h3>String formatting</h3>
                String formatting in Python also has its own problems. They are not problems like in chapter 3 where is memory the main problem, but bad string formatting can cause can cause leak of data. Through <i>str.format()</i> can attacker see internal parts of objects or some sensitive data.
                The best solution is to check user input using whitelisting or do not have user input at all. Other solutions include using "old" style formatting. That type of formatting is similar to C string formatting and it is relatively secure. Its cons are smaller clarity and longer code. Other solutions are to use f-strings (Python 3.6+) or template stings from standard library.
                
                <h3>XML</h3>
                Sometimes it is needed XML input to proper working program. There are several Python modules which can help with XML. Problem is that every XML Python module out there is vulnerable against two types of attacks. The first one is called Billion laughs attack and the second one The Quadratic blowup. The best practise here is using package defusedxml. Defusedxml is created to prevent especially these two attacks.
                
                
                <h3>Random</h3>
                Generating numbers can be more secure than with standard random from standard library. Its algorithm is quite predictable. Use module with <i>secret.random()</i> instead. All the more if programmer is using generator for secret or encrypted needs.
                
                <h3>Assert</h3>
                Assert comes very handy in testing, because programmer can assume with this statement that the assertion is true and if it is not Python raise assertion error. But assert should be used only in testing, because having assertion in production code is vulnerability. Assert can be carried out only if Python's variable <i>__debug__</i> is set to true. Even if the variable is set to true  does not mean that in every environment on every device is set to true. Out of this problem can raise problem where interpret skips part of the code or executes part of the code that should not be executed. It can created undefined behavior.
                
                <h3>Tarfile and zipfile</h3>
                Tarfile is module for extracting archives. Programmer should avoid using tarfile when extracting from untrusted sources. In the archive could be file with absolute path containing .. or / which can cause problem because functions in tarfile can not handle that. Use module tarsafe instead.</br>
                The second problem with archive files is so called "zip bomb". This bomb has one goal. Crush the host's system or program by decompressing small file containing amount of data bigger than host's memory. Programmer can defend setting and checking maximum size of decompressed data and maximum number of files. This <a href="https://www.bamsoftware.com/hacks/zipbomb/">link</a> shows .zip files having a few kilobytes compressed but after decompression they needs terabytes of free space.
              </div>
                
              <div id="web_program">
                <h2>Web programming</h2>
                This part of coding is very popular these days. Most of the world depends on internet and web applications are the best way how to do things on the internet. But every sun creates a shade. Web applications are vulnerable against many types of attacks. Problem with web applications is that they store sensitive data about users, their passwords and so on. This section should introduce the worst web programming vulnerabilities and their solution.
                
                <h3>OWASP Top 10</h3>
                This section is focused on OWASP Top 10 for Python. Not every item on the list is suitable for guidelines for Python. Therefore only these selected items will be described.
                
                <h3>Broken access control</h3>
                The most common exploit is called Broken access control. This exploit appeared in 318 thousands web apps that were tested. This number shows how many vulnerable applications are there, whilst it is known that this exploit can be very dangerous.</br>
                The attacker can bypass access control by modifying the HTML page or the URL of the site, or modifying internal application state. This can cause elevation of privilege which is acting as user when not logged or as admin when not logged as admin and so on. Other problems that BAC can cause are metadata manipulation, cookie manipulation or force browsing to authenticated pages as unauthorized user. We can defend effectively only in trusted server-side code or server-less API, where the attacker cannot modify the access control check or metadata.
                
                <h3>Cryptographic failures</h3>
                Second-largest exploit is not a root cause, but more of a symptom. The main problem with cryptography is that it use to be broken and data are visible in the transmission. That is why we have to check if we transmit data in right format and encrypted and check what kind of encryption we use. Personal information has to be encrypted due to EU privacy laws (GDPR).</br>
                The solution is simple. For private data transmission use HTTPS instead of HTTP which is not encrypted. For other types of encrypted communication, such as SMTP, use TLS for encryption. Check if the server is trusted and check for needed certificates. Update encryption methods for methods that are more powerful and secure. If using generated cryptographic keys, be sure that they are meeting requirements. If possible use authenticated encryption, it is better than only encryption.
                Also if not needed do not store sensitive data. Data that are not stored, can not be stolen.
                
                <h3>Injection</h3>
                This category was composed of several types of injection including SQL injection, cross site scripting and others. The most common injection is SQL injection that occurs when a programmer, for example, uses credentials directly from an authentication form to perform a SQL query. This bad practise that can even lead to deletion or leaking of whole user database.</br>
                Preventing this attack is really simple. Do not trust user input. Validate what user wrote and restrict length of input or characters that can user use. When creating a SQL query, use only user input that has gone through validation.</br>
                Example: user wrote in the field for password 'or 1=1)\# . This string in SQL query expands the query for or 1=1. This part of string means for example log user if 1=1, which is always true. User just breached the system. The lesson from this example is that a programmer should never use user input unverified.
                
                <h3>Identification and authentication failures</h3>
                This category contains every possible way of attack on authentication.
                The easiest attack to defend from is a brute force attack. It combines random or not random strings that are from database or some other source and tries to authenticate. This type of attack can be defended just by putting number of tries on the form and then trying to send the user a notification on email or something.</br>
                Another vulnerability is weak password. The form should not accept passwords that do not contain upper-case and lower-case character, number and special character like '*' or '.'. The more complicated password, the lesser the chance of breaching of account.</br>
                Password has to be transmitted and stored in encrypted form. So as session ID.</br>
                Weakness is also password recovery that contains safety private questions. This is also not user-friendly, so it is not recommended for using by usability either because users can forget. It is vulnerable against brute force attacks. Sending notification through e-mail is safer.
                
                
                <h3>Security logging and monitoring failures</h3>
                This chapter is kind of hard to understand. It can not be tested at all or very hardly. The problem is that the application should be logging what is doing. Every error, every suspicious activity, change in configuration and so on.</br>
                The suggestion is that logging is important, and every application should have a log files that are not stored only locally, but on a server as well because logging can save us a lot of troubles when dealing with security problems.
                
                <h3>Server side request forgery</h3>
                This can happen when a web application is fetching a remote resource without validation of user supplied URL. This can cause a redirecting to a malicious web or other places even when protected by a firewall, VPN and so on. Server side request forgery is on the rise with new modern web applications that uses user provided URLs.</br>
                Preventing is again validating user input, disable HTTP redirections and checking consistency of URLs.
              </div>
                
              <div id="others">
                <h2>Others</h2>
                There are other vulnerabilities as well. There is a list with vulnerabilities that did not make it into this thesis.
                <ul>
                    <li>Item 1</li>
                    <li>Item 2</li>
                    <li>Item 3</li>
                    <li>Item 4</li>
                </ul>
              </div>
            </div>

          <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8 collapse tests" id="tests">
            <h2>Test:</h2>
            <p>This part of application is focused on revision of your knowledge. In every topic there will be 5 questions.
              If your answer is correct one point will be awarded. There are maximum of 15 points. In regards of your results there is a scale
              of knowledge by points rewarded.
            </p>
            <ul>
              <li>15 - 12 => you can code securely</li>
              <li>11 -  8 => you know what is secure coding</li>
              <li> 7 -  4 => try reading guidelines again</li>
              <li> 4 -  0 => secure coding is not your thing</li>
            </ul>
            Try perform the test without opening guidelines. There will be no restriction, but this test is for testing your knowledge and
            understanding the concern.

            <h3 id="basics_test">Basics</h3>
            <!-- Question 1 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 1: What is the recommended Python version?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="310" name="version_Python" value="3.10.0">
                  <label for="310">3.10.0</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="27" name="version_Python" value="2.7">
                  <label for="27">2.7</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="30" name="version_Python" value="3.0">
                  <label for="30">3.0</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="38" name="version_Python" value="3.8">
                  <label for="38">3.8</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk1" name="version_Python" value="idk" checked>
                  <label for="idk1">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 2 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 2: Why is recommended using venv (virtual environment)?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="venv_1" name="venv" value="a">
                  <label for="venv_1">Because faster Python interpretation of code.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="venv_2" name="venv" value="b">
                  <label for="venv_2">Because potentionally malicious code would effect only this projct in venv.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="venv_3" name="venv" value="c">
                  <label for="venv_3">Because venv prevents from code injection from input.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="venv_4" name="venv" value="d">
                  <label for="venv_4">Because project cannot be created without venv.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk2" name="venv" value="idk" checked>
                  <label for="idk2">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 3 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 3: What kind of module import is this?</th>
              </tr>
              <tr>
                <td class="text-center"><img src="../static/images/absolute.png"></td>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="imp_1" name="import" value="a">
                  <label for="imp_1">Absolute</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="imp_2" name="import" value="b">
                  <label for="imp_2">Relative</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="imp_3" name="import" value="c">
                  <label for="imp_3">Implicit</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="imp_4" name="import" value="d">
                  <label for="imp_4">Explicit</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk3" name="import" value="idk" checked>
                  <label for="idk3">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 4 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 4: How should programmer import module?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="how_imp_1" name="how_imp" value="a">
                  <label for="how_imp_1">Do not import modules at all.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="how_imp_2" name="how_imp" value="b">
                  <label for="how_imp_2">Import all from the module.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="how_imp_3" name="how_imp" value="c">
                  <label for="how_imp_3">Import all different modules and then choose needed functions.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="how_imp_4" name="how_imp" value="d">
                  <label for="how_imp_4">Import only needed methods.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk4" name="how_imp" value="idk" checked>
                  <label for="idk4">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 5 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 5: What is typosquatting?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="typo_squat_1" name="typo_squat" value="a">
                  <label for="typo_squat_1">Creating malicious module with intentional typo and
                    waiting for programmer to make a typo when importing.
                  </label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="typo_squat_2" name="typo_squat" value="b">
                  <label for="typo_squat_2">Sending a letter to a company which has a typo on their website.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="typo_squat_3" name="typo_squat" value="c">
                  <label for="typo_squat_3">Error in Python interpreter which means that programmer made a typo.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="typo_squat_4" name="typo_squat" value="d">
                  <label for="typo_squat_4">None of these above.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk5" name="typo_squat" value="idk" checked>
                  <label for="idk5">I do not know</label>
                </div>
              </div>
            </form>


            <h3 id="standard_test">Standard library</h3>

            <!-- Question 6 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 6: The best way how to handle input according to the guidelines?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="input_handle_1" name="input_handle" value="a">
                  <label for="input_handle_1">Do not having input at all</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="input_handle_2" name="input_handle" value="b">
                  <label for="input_handle_2">No checking</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="input_handle_3" name="input_handle" value="c">
                  <label for="input_handle_3">Blacklisting</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="input_handle_4" name="input_handle" value="d">
                  <label for="input_handle_4">Whitelisting</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk6" name="input_handle" value="idk" checked>
                  <label for="idk6">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 7 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 7: What is so called "zip bomb"?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="zip_bomb_question_1" name="zip_bomb_question" value="a">
                  <label for="zip_bomb_question_1">A special file which should decrypt any encrypted .zip files.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="zip_bomb_question_2" name="zip_bomb_question" value="b">
                  <label for="zip_bomb_question_2">An attack where unziping such file crashes down
                     an app or system because of needed size.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="zip_bomb_question_3" name="zip_bomb_question" value="c">
                  <label for="zip_bomb_question_3">A kind of army bomb which is dropped in zip formations.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="zip_bomb_question_4" name="zip_bomb_question" value="d">
                  <label for="zip_bomb_question_4">A spam of zip files in email client.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk7" name="zip_bomb_question" value="idk" checked>
                  <label for="idk7">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 8 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 8: When to use if-else?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="if_else_1" name="if_else" value="a">
                  <label for="if_else_1">When programmer does not know which errors can occur.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="if_else_2" name="if_else" value="b">
                  <label for="if_else_2">When it is big possibility of an error.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="if_else_3" name="if_else" value="c">
                  <label for="if_else_3">When it is small possibility of an error.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="if_else_4" name="if_else" value="d">
                  <label for="if_else_4">When working with files.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk8" name="if_else" value="idk" checked>
                  <label for="idk8">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 9 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 9: Which of these methods was patched from Python 3.0 on wards?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="method_patch_1" name="method_patch" value="a">
                  <label for="method_patch_1">os.system()</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="method_patch_2" name="method_patch" value="b">
                  <label for="method_patch_2">input()</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="method_patch_3" name="method_patch" value="c">
                  <label for="method_patch_3">eval()</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="method_patch_4" name="method_patch" value="d">
                  <label for="method_patch_4">exec()</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk9" name="method_patch" value="idk" checked>
                  <label for="idk9">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 10 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 10: What attack can attacker create by using regular expression?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="redos_attack_1" name="redos_attack" value="a">
                  <label for="redos_attack_1">ReDoS</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="redos_attack_2" name="redos_attack" value="b">
                  <label for="redos_attack_2">DDOS</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="redos_attack_3" name="redos_attack" value="c">
                  <label for="redos_attack_3">Injection</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="redos_attack_4" name="redos_attack" value="d">
                  <label for="redos_attack_4">Typosquatting</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk10" name="redos_attack" value="idk" checked>
                  <label for="idk10">I do not know</label>
                </div>
              </div>
            </form>

            <h3 id="web_test">Web programming</h3>

            <!-- Question 11 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 11: Which organisation makes list of 10 most occuring web app vulnerabilities?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="top_ten_1" name="top_ten" value="a">
                  <label for="top_ten_1">IANA</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="top_ten_2" name="top_ten" value="b">
                  <label for="top_ten_2">NIST</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="top_ten_3" name="top_ten" value="c">
                  <label for="top_ten_3">OWASP</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="top_ten_4" name="top_ten" value="d">
                  <label for="top_ten_4">IEEE</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk11" name="top_ten" value="idk" checked>
                  <label for="idk11">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 12 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 12: What is the top 1 vulnerability in the 2021 list?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="top_one_1" name="top_one" value="a">
                  <label for="top_one_1">Broken access control</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="top_one_2" name="top_one" value="b">
                  <label for="top_one_2">Injection</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="top_one_3" name="top_one" value="c">
                  <label for="top_one_3">Broken authentication</label>
                </div>
                <div class="col-xs-12 col-sm-6">
                  <input type="radio" id="top_one_4" name="top_one" value="d">
                  <label for="top_one_4">Cryptographic failures</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk12" name="top_one" value="idk" checked>
                  <label for="idk12">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 13 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 13: How to prevent from cryptographic failures vulnerability?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="crypto_prevent_1" name="crypto_prevent" value="a">
                  <label for="crypto_prevent_1">By not encrypting any data.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="crypto_prevent_2" name="crypto_prevent" value="b">
                  <label for="crypto_prevent_2">By using open source cryptographic algorithms.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="crypto_prevent_3" name="crypto_prevent" value="c">
                  <label for="crypto_prevent_3">By using HTTP for requests.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="crypto_prevent_4" name="crypto_prevent" value="d">
                  <label for="crypto_prevent_4">By using the most recent and updated cryptographic algorithms.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk13" name="crypto_prevent" value="idk" checked>
                  <label for="idk13">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 14 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 14: How to prevent from SQL injection vulnerability?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="injection_prevent_1" name="injection_prevent" value="a">
                  <label for="injection_prevent_1">By validating user input before running sql query.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="injection_prevent_2" name="injection_prevent" value="b">
                  <label for="injection_prevent_2">By executing queries right after user writes input.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="injection_prevent_3" name="injection_prevent" value="c">
                  <label for="injection_prevent_3">By checking if user is from trusted domain.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="injection_prevent_4" name="injection_prevent" value="d">
                  <label for="injection_prevent_4">By setting the maximum lenght of input on 15 characters.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk14" name="injection_prevent" value="idk" checked>
                  <label for="idk14">I do not know</label>
                </div>
              </div>
            </form>

            <!-- Question 15 -->
            <table class="table table-bordered">
              <tr>
                <th class="th_color">Question 15: What happens after theft of session ID?</th>
              </tr>
            </table>
            <form style="padding-bottom:30px;">
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="session_ID_1" name="session_ID" value="a">
                  <label for="session_ID_1">Attacker steals user's IP address.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="session_ID_2" name="session_ID" value="b">
                  <label for="session_ID_2">Attacker can steal money from user's bank account. (session_ID of bank account login)</label>
                </div>
              </div>
              <div class="row">
                <div class="col-12 padding_radio">
                  <input type="radio" id="session_ID_3" name="session_ID" value="c">
                  <label for="session_ID_3">Attacker can do nothing, because session ID cannot be stolen.</label>
                </div>
                <div class="col-12 padding_radio">
                  <input type="radio" id="session_ID_4" name="session_ID" value="d">
                  <label for="session_ID_4">None of these above.</label>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12 col-sm-12">
                  <input type="radio" id="idk15" name="session_ID" value="idk" checked>
                  <label for="idk15">I do not know</label>
                </div>
              </div>
            </form>
            
            {% if request.user.is_authenticated %}
              <div style="width:100%; text-align:center;">
                <form>
                  <input data-toggle="collapse" data-target="#get_points" class="btn btn-dark" type="button" onclick="get_points()" value="Submit" style="background-color:#777; color:white;">
                </form>
                <div class="collapse" id="get_points">
                  <h2>Your points: <span id="points"></span>/15. Congratulations!</h2>
                  <button class="btn btn-dark" onclick="location.href='/'" style="background-color:#777; color:white;">Refresh</button>
                </div>
              </div>
            {% else %}
              <div style="width:100%; text-align:center;">
                <h3>Please register or login for checking results.</h3>
              </div>
            {% endif %}      
          </div>


          <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8 collapse" id="files">
          {% if request.user.is_authenticated %}
            <h3>Files to download:</h3>
            <ul>
              <li>Example wrong import: <a href="../static/files/import_override.py" download>link</a></li>
              <li>Example typosquatting: <a href="../static/files/modules.zip" download>link</a></li>
              <li>Example input validation: <a href="../static/files/input.py" download>link</a></li>
              <li>Example creating file: <a href="../static/files/file.py">link</a></li>
              <li>Example command injection: <a href="../static/files/command_inj.py">link</a></li>
            </ul>
          {% else %}
            <p style="padding-top:20px;">
              Downloading files is available only for registered users.
            </p>
          {% endif %}
          </div>
        </div>
        </div>
       </div> 
       <footer class="bg-light text-center text-lg-start" style="padding-top:30px;">
        <div class="text-center p-3" style="background-color: #555; padding-top:30px; padding-bottom:25px; color:white;">
          ©2022 BUT FIT
        </div>
      </footer>
   </body>
</html>